This code was authored by Jonathan Protzenko (MSR).
